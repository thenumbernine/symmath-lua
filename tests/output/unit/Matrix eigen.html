<!doctype html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>tests/unit/Matrix eigen</title>
		<script type='text/javascript' src='../tryToFindMathJax.js'></script>
		<link rel='stylesheet' href='../darkmode.css'></link>
		<script type='text/javascript' src='../darkmode.js'></script>
	</head>
	<body>

<table border="1" style="border-collapse:collapse">
<tr><td>
<b>printbr(A:eq(eig.R * eig.Lambda * eig.L))
printbr('permuting to', A:eq(eig.R * eig.Lambda * eig.L))</b><br>
<pre>local A = Matrix({-6, 3}, {4, 5})
local ch = A:charpoly(lambda)
printbr(ch)
local solns = table{ch:solve(lambda)}
printbr(solns:mapi(tostring):concat',')
simplifyAssertEq(ch, (lambda^2 + lambda - 42):eq(0))
local eig = A:eigen()


if Constant.isValue(eig.Lambda[1][1], 6) then local P = Matrix({0,1},{1,0}) eig.R = (eig.R * P)() eig.Lambda = (P * eig.Lambda * P)() eig.L = (P * eig.L)() end


simplifyAssertEq(eig.L, Matrix({-frac(4,13), frac(1,13)}, {frac(4, 13), frac(12,13)}))
simplifyAssertEq(eig.R, Matrix({-3, frac(1,4)}, {1, 1}))
simplifyAssertEq(eig.Lambda, Matrix.diagonal(-7, 6))</pre>
</td><td>
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda)
found two sum	6 + \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda)
found two sum	6 + \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda)
found two sum	6 + \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * (6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(5 + -1 * \lambda) * (6 + \lambda)
found two sum	5 + -1 * \lambda
found two sum	6 + \lambda
differenceOfSquares	-1 * (12 + (5 + -1 * \lambda) * (6 + \lambda))
found two sum	12 + (5 + -1 * \lambda) * (6 + \lambda)
differenceOfSquares	-1 * \lambda
differenceOfSquares	(6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * (12 + (6 + \lambda) * (5 + -1 * \lambda))
found two sum	12 + (6 + \lambda) * (5 + -1 * \lambda)
differenceOfSquares	-1 * \lambda
differenceOfSquares	(6 + \lambda) * (5 + -1 * \lambda)
found two sum	6 + \lambda
found two sum	5 + -1 * \lambda
differenceOfSquares	-1 * (12 + (6 + \lambda) * (5 + -1 * \lambda))
found two sum	12 + (6 + \lambda) * (5 + -1 * \lambda)
${-{\left({{12} + {{{\left({{6} + {\lambda}}\right)}} {{\left({{5}{-{\lambda}}}\right)}}}}\right)}} = {0}$
<br>
differenceOfSquares	-1 * \lambda
differenceOfSquares	(5 + -1 * \lambda) * (6 + \lambda)
found two sum	5 + -1 * \lambda
found two sum	6 + \lambda
differenceOfSquares	-1 * (12 + (5 + -1 * \lambda) * (6 + \lambda))
found two sum	12 + (5 + -1 * \lambda) * (6 + \lambda)
differenceOfSquares	5 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-6 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda * \lambda
differenceOfSquares	-1 * \lambda^2
differenceOfSquares	5 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda^2
${\lambda} = {6}$,${\lambda} = {-{7}}$
<br>
${{-{\left({{12} + {{{\left({{6} + {\lambda}}\right)}} {{\left({{5}{-{\lambda}}}\right)}}}}\right)}} = {0}} = {{{{{\lambda}^{2}} + {\lambda}}{-{42}}} = {0}}$
<br>
differenceOfSquares	-1 * \lambda
differenceOfSquares	(5 + -1 * \lambda) * (6 + \lambda)
found two sum	5 + -1 * \lambda
found two sum	6 + \lambda
differenceOfSquares	-1 * (12 + (5 + -1 * \lambda) * (6 + \lambda))
found two sum	12 + (5 + -1 * \lambda) * (6 + \lambda)
differenceOfSquares	5 * \lambda
differenceOfSquares	-5 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-6 * \lambda
differenceOfSquares	6 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda * \lambda
differenceOfSquares	-1 * \lambda^2
differenceOfSquares	-5 * \lambda
differenceOfSquares	\lambda * \lambda
differenceOfSquares	\lambda * \lambda
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ)
found two sum	6 + λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ)
found two sum	6 + λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ)
found two sum	6 + λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * (6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(5 + -1 * λ) * (6 + λ)
found two sum	5 + -1 * λ
found two sum	6 + λ
differenceOfSquares	-1 * (12 + (5 + -1 * λ) * (6 + λ))
found two sum	12 + (5 + -1 * λ) * (6 + λ)
differenceOfSquares	-1 * λ
differenceOfSquares	(6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * (12 + (6 + λ) * (5 + -1 * λ))
found two sum	12 + (6 + λ) * (5 + -1 * λ)
differenceOfSquares	-1 * λ
differenceOfSquares	(6 + λ) * (5 + -1 * λ)
found two sum	6 + λ
found two sum	5 + -1 * λ
differenceOfSquares	-1 * (12 + (6 + λ) * (5 + -1 * λ))
found two sum	12 + (6 + λ) * (5 + -1 * λ)
differenceOfSquares	-1 * λ
differenceOfSquares	(5 + -1 * λ) * (6 + λ)
found two sum	5 + -1 * λ
found two sum	6 + λ
differenceOfSquares	-1 * (12 + (5 + -1 * λ) * (6 + λ))
found two sum	12 + (5 + -1 * λ) * (6 + λ)
differenceOfSquares	5 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-6 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ * λ
differenceOfSquares	-1 * λ^2
differenceOfSquares	5 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ^2
differenceOfSquares	-1 * 1 / 4
differenceOfSquares	-1 * 1 / 4
differenceOfSquares	4 * -1 / 4
differenceOfSquares	-2 * 1 / 2
differenceOfSquares	-1 * 1 / 12
differenceOfSquares	-1 * 1 / 12
differenceOfSquares	4 * -1 / 12
differenceOfSquares	-2 * 1 / 2
differenceOfSquares	-1 * -1 / 3
differenceOfSquares	-1 * 1 / 4
differenceOfSquares	-1 * -1 / 4
differenceOfSquares	3 * 4 / 13
differenceOfSquares	-1 * 4 / 13
differenceOfSquares	1 / 4 * 4 / 13
differenceOfSquares	2 * 1 / 2
differenceOfSquares	-1 * 4 / 13
${\left[\begin{array}{cc} -{\frac{4}{13}}& \frac{1}{13}\\ \frac{4}{13}& \frac{12}{13}\end{array}\right]} = {\left[\begin{array}{cc} -{\frac{4}{13}}& \frac{1}{13}\\ \frac{4}{13}& \frac{12}{13}\end{array}\right]}$
<br>
differenceOfSquares	-1 * 4 / 13
differenceOfSquares	-1 * 4 / 13
${\left[\begin{array}{cc} -{3}& \frac{1}{4}\\ 1& 1\end{array}\right]} = {\left[\begin{array}{cc} -3& \frac{1}{4}\\ 1& 1\end{array}\right]}$
<br>
${\left[\begin{array}{cc} -{7}& 0\\ 0& 6\end{array}\right]} = {\left[\begin{array}{cc} -7& 0\\ 0& 6\end{array}\right]}$
<br>

<span style="color:green">GOOD</span>
</td><td>
time: 115.921000ms<br>
stack: size: 7<br><ul style="margin:0px"><li>Init<br><li>Prune<br><li>Expand<br><li>Prune<br><li>Factor<br><li>Prune<br><li>Tidy</ul>
</td></tr>
<tr><td>
<b>printbr('permuting to', A:eq(eig.R * eig.Lambda * eig.L))</b><br>
<pre>local A = Matrix({2, 0, 0}, {0, 4, 5}, {0, 4, 3})
local ch = A:charpoly(lambda)
printbr(ch)
local solns = table{ch:solve(lambda)}
printbr(solns:mapi(tostring):concat',')
local eig = A:eigen()
printbr(A:eq(eig.R * eig.Lambda * eig.L))
if Constant.isValue(eig.Lambda[1][1], 6) then local P = Matrix({0,1},{1,0}) eig.R = (eig.R * P)() eig.Lambda = (P * eig.Lambda * P)() eig.L = (P * eig.L)() printbr('permuting to', A:eq(eig.R * eig.Lambda * eig.L)) end


simplifyAssertEq(eig.R, Matrix({1, 0, 0}, {0, -1, 1}, {0, frac(5,4), 1}):T())
simplifyAssertEq(eig.L, Matrix({1, 0, 0}, {0, -frac(4,9), frac(4,9)}, {0, frac(5,9), frac(4,9)}):T())
simplifyAssertEq(eig.Lambda, Matrix.diagonal(2, -1, 8))</pre>
</td><td>
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(3 + -1 * \lambda) * (4 + -1 * \lambda)
found two sum	3 + -1 * \lambda
found two sum	4 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(4 + -1 * \lambda) * (3 + -1 * \lambda)
found two sum	4 + -1 * \lambda
found two sum	3 + -1 * \lambda
differenceOfSquares	(-20 + (4 + -1 * \lambda) * (3 + -1 * \lambda)) * (2 + -1 * \lambda)
found two sum	-20 + (4 + -1 * \lambda) * (3 + -1 * \lambda)
found two sum	2 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(3 + -1 * \lambda) * (4 + -1 * \lambda)
found two sum	3 + -1 * \lambda
found two sum	4 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(2 + -1 * \lambda) * (-20 + (3 + -1 * \lambda) * (4 + -1 * \lambda))
found two sum	2 + -1 * \lambda
found two sum	-20 + (3 + -1 * \lambda) * (4 + -1 * \lambda)
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(4 + -1 * \lambda) * (3 + -1 * \lambda)
found two sum	4 + -1 * \lambda
found two sum	3 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(3 + -1 * \lambda) * (4 + -1 * \lambda)
found two sum	3 + -1 * \lambda
found two sum	4 + -1 * \lambda
differenceOfSquares	(-20 + (3 + -1 * \lambda) * (4 + -1 * \lambda)) * (2 + -1 * \lambda)
found two sum	-20 + (3 + -1 * \lambda) * (4 + -1 * \lambda)
found two sum	2 + -1 * \lambda
${{{\left({{-{20}} + {{{\left({{3}{-{\lambda}}}\right)}} {{\left({{4}{-{\lambda}}}\right)}}}}\right)}} {{\left({{2}{-{\lambda}}}\right)}}} = {0}$
<br>
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(4 + -1 * \lambda) * (3 + -1 * \lambda)
found two sum	4 + -1 * \lambda
found two sum	3 + -1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	(2 + -1 * \lambda) * (-20 + (4 + -1 * \lambda) * (3 + -1 * \lambda))
found two sum	2 + -1 * \lambda
found two sum	-20 + (4 + -1 * \lambda) * (3 + -1 * \lambda)
differenceOfSquares	-1 * \lambda
differenceOfSquares	-4 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-3 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	-1 * \lambda
differenceOfSquares	\lambda * \lambda
differenceOfSquares	-4 * \lambda
differenceOfSquares	-7 * \lambda
differenceOfSquares	-7 * \lambda
differenceOfSquares	-7 * \lambda
${\lambda} = {2}$,${\lambda} = {-{1}}$,${\lambda} = {8}$
<br>
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(3 + -1 * λ) * (4 + -1 * λ)
found two sum	3 + -1 * λ
found two sum	4 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(4 + -1 * λ) * (3 + -1 * λ)
found two sum	4 + -1 * λ
found two sum	3 + -1 * λ
differenceOfSquares	(-20 + (4 + -1 * λ) * (3 + -1 * λ)) * (2 + -1 * λ)
found two sum	-20 + (4 + -1 * λ) * (3 + -1 * λ)
found two sum	2 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(3 + -1 * λ) * (4 + -1 * λ)
found two sum	3 + -1 * λ
found two sum	4 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(2 + -1 * λ) * (-20 + (3 + -1 * λ) * (4 + -1 * λ))
found two sum	2 + -1 * λ
found two sum	-20 + (3 + -1 * λ) * (4 + -1 * λ)
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(4 + -1 * λ) * (3 + -1 * λ)
found two sum	4 + -1 * λ
found two sum	3 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(3 + -1 * λ) * (4 + -1 * λ)
found two sum	3 + -1 * λ
found two sum	4 + -1 * λ
differenceOfSquares	(-20 + (3 + -1 * λ) * (4 + -1 * λ)) * (2 + -1 * λ)
found two sum	-20 + (3 + -1 * λ) * (4 + -1 * λ)
found two sum	2 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(4 + -1 * λ) * (3 + -1 * λ)
found two sum	4 + -1 * λ
found two sum	3 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(2 + -1 * λ) * (-20 + (4 + -1 * λ) * (3 + -1 * λ))
found two sum	2 + -1 * λ
found two sum	-20 + (4 + -1 * λ) * (3 + -1 * λ)
differenceOfSquares	-1 * λ
differenceOfSquares	-4 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-3 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	λ * λ
differenceOfSquares	-4 * λ
differenceOfSquares	-7 * λ
differenceOfSquares	-7 * λ
differenceOfSquares	-7 * λ
differenceOfSquares	4 * 5 / 2
differenceOfSquares	4 * 1 / 2
differenceOfSquares	-1 * 5 / 2
differenceOfSquares	2 * -5 / 2
differenceOfSquares	5 / 2 * 2 / 9
differenceOfSquares	-1 * 5 / 9
differenceOfSquares	2 * -5 / 9
differenceOfSquares	-1 * 1 / 9
differenceOfSquares	5 / 2 * -1 / 9
differenceOfSquares	-1 * -5 / 18
differenceOfSquares	-1 * 1 / 9
differenceOfSquares	4 * 1 / 5
differenceOfSquares	-1 * 4 / 5
differenceOfSquares	-1 * 1 / 6
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	4 * -5 / 4
differenceOfSquares	-10 * 1 / 2
differenceOfSquares	-1 * 1 / 6
differenceOfSquares	-1 * 1 / 4
differenceOfSquares	-1 * 1 / 4
differenceOfSquares	4 * -1 / 4
differenceOfSquares	-2 * 1 / 2
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	-1 * -5 / 4
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	-1 * 5 / 4
differenceOfSquares	-1 * 9 / 4
differenceOfSquares	-9 / 4 * -4 / 9
differenceOfSquares	-5 / 4 * -4 / 9
differenceOfSquares	10 * 1 / 2
differenceOfSquares	-1 * -4 / 9
differenceOfSquares	-1 * -4 / 9
${\left[\begin{array}{ccc} 2& 0& 0\\ 0& 4& 5\\ 0& 4& 3\end{array}\right]} = {{{\left[\begin{array}{ccc} 1& 0& 0\\ 0& -{1}& \frac{5}{4}\\ 0& 1& 1\end{array}\right]}} {{\left[\begin{array}{ccc} 2& 0& 0\\ 0& -{1}& 0\\ 0& 0& 8\end{array}\right]}} {{\left[\begin{array}{ccc} 1& 0& 0\\ 0& -{\frac{4}{9}}& \frac{5}{9}\\ 0& \frac{4}{9}& \frac{4}{9}\end{array}\right]}}}$
<br>
${\left[\begin{array}{ccc} 1& 0& 0\\ 0& -{1}& \frac{5}{4}\\ 0& 1& 1\end{array}\right]} = {\left[\begin{array}{ccc} 1& 0& 0\\ 0& -1& \frac{5}{4}\\ 0& 1& 1\end{array}\right]}$
<br>
${\left[\begin{array}{ccc} 1& 0& 0\\ 0& -{\frac{4}{9}}& \frac{5}{9}\\ 0& \frac{4}{9}& \frac{4}{9}\end{array}\right]} = {\left[\begin{array}{ccc} 1& 0& 0\\ 0& -{\frac{4}{9}}& \frac{5}{9}\\ 0& \frac{4}{9}& \frac{4}{9}\end{array}\right]}$
<br>
differenceOfSquares	-1 * 4 / 9
differenceOfSquares	-1 * 4 / 9
${\left[\begin{array}{ccc} 2& 0& 0\\ 0& -{1}& 0\\ 0& 0& 8\end{array}\right]} = {\left[\begin{array}{ccc} 2& 0& 0\\ 0& -1& 0\\ 0& 0& 8\end{array}\right]}$
<br>

<span style="color:green">GOOD</span>
</td><td>
time: 91.906000ms<br>
stack: size: 7<br><ul style="margin:0px"><li>Init<br><li>Prune<br><li>Expand<br><li>Prune<br><li>Factor<br><li>Prune<br><li>Tidy</ul>
</td></tr>
<tr><td>
<b>printbr(A:eq(eig.R * eig.Lambda * eig.L))
 OK HERE ... what about lambda, and their associations with R and L in the generalized system?</b><br>
<pre>local A = Matrix({1, 1}, {0, 1})
printbr'<b>without generalization:</b>'
local eig = A:eigen()
for k,v in pairs(eig) do
	printbr(k, '=', v)
end
assert(eig.defective)
assertEq(eig.R, Matrix{1, 0}:T())
simplifyAssertAllEq(eig.allLambdas, {1})



printbr'<b>with generalization:</b>'
eig = A:eigen{generalize=true, verbose=true}
for k,v in pairs(eig) do
	printbr(k, '=', v)
end
printbr('#allLambdas', #eig.allLambdas)
printbr('#lambdas', #eig.lambdas)
printbr('lambdas', eig.lambdas:mapi(function(l) return '{mult='..l.mult..', expr='..l.expr..'}' end):concat',')
simplifyAssertEq(eig.L, Matrix.identity(2))
simplifyAssertEq(eig.R, Matrix.identity(2))</pre>
</td><td>
<b>without generalization:</b>
<br>
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(1 + -1 * λ) * (1 + -1 * λ)
found two sum	1 + -1 * λ
found two sum	1 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(1 + -1 * λ) * (1 + -1 * λ)
found two sum	1 + -1 * λ
found two sum	1 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
lambdas	=	table: 0x7fab84f2c3b0
<br>
defective	=	true
<br>
R	=	$\left[\begin{array}{c} 1\\ 0\end{array}\right]$
<br>
charPoly	=	${{\left({{1}{-{λ}}}\right)}^{2}} = {0}$
<br>
Lambda	=	$\left[\begin{array}{c} 1\end{array}\right]$
<br>
allLambdas	=	table: 0x7fab84f2c498
<br>
${\left[\begin{array}{c} 1\\ 0\end{array}\right]} = {\left[\begin{array}{c} 1\\ 0\end{array}\right]}$
<br>
${1} = {1}$
<br>
${1} = {1}$
<br>
${1} = {1}$
<br>
<b>with generalization:</b>
<br>
${A} = {\left[\begin{array}{cc} 1& 1\\ 0& 1\end{array}\right]}$
<br>
${I} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
${{A}{-{{{λ}} \cdot {{I}}}}} = {\left[\begin{array}{cc} {1}{-{λ}}& 1\\ 0& {1}{-{λ}}\end{array}\right]}$
<br>
charPoly	${{{\left({{1}{-{λ}}}\right)}} {{\left({{1}{-{λ}}}\right)}}} = {0}$
<br>
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(1 + -1 * λ) * (1 + -1 * λ)
found two sum	1 + -1 * λ
found two sum	1 + -1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	-1 * λ
differenceOfSquares	(1 + -1 * λ) * (1 + -1 * λ)
found two sum	1 + -1 * λ
found two sum	1 + -1 * λ
differenceOfSquares	-1 * λ
after simplify(), charPoly	${{\left({{1}{-{λ}}}\right)}^{2}} = {0}$
<br>
differenceOfSquares	-1 * λ
${λ} = {1}$, ${λ} = {1}$
<br>
$λ$	$= \{$	$1$, $1$	$\}$
<br>
mult 2 expr $1$
<br>
finding nullspace for 	$1$
<br>
$\left[\begin{array}{c} 1\\ 0\end{array}\right]$
<br>
...is defective, gathering more generalized eigenvectors
<br>
trying again for generalized eigensystem...
<br>
finding nullspace of (A - I λ)^2 = $\left[\begin{array}{cc} 0& 0\\ 0& 0\end{array}\right]$
<br>
which is $\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]$
<br>
nullspace dim of (A - I λ)^2 =	2
<br>
...times (A - λ I) is $\left[\begin{array}{cc} 0& 1\\ 0& 0\end{array}\right]$
<br>
checking new potential vector product	$\left[\begin{matrix} 0 \\ 0\end{matrix}\right]$
<br>
...and it's all zeroes so we already considered this vector
<br>
checking new potential vector product	$\left[\begin{matrix} 1 \\ 0\end{matrix}\right]$
<br>
adding col 2
<br>
right eigenvector of λ=	$1$	is	$\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]$
<br>
${R} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
${L} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
${Λ} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
verify:
<br>
${{{\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}} {{\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}} {{\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}}} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
lambdas	=	table: 0x7fab84fe98c0
<br>
defective	=	true
<br>
R	=	$\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]$
<br>
L	=	$\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]$
<br>
charPoly	=	${{\left({{1}{-{λ}}}\right)}^{2}} = {0}$
<br>
Lambda	=	$\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]$
<br>
allLambdas	=	table: 0x7fab84fe9ba8
<br>
#allLambdas	2
<br>
#lambdas	1
<br>
lambdas	{mult=2, expr=$1$}
<br>
${\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>
${\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]} = {\left[\begin{array}{cc} 1& 0\\ 0& 1\end{array}\right]}$
<br>

<span style="color:green">GOOD</span>
</td><td>
time: 28.877000ms<br>
stack: size: 7<br><ul style="margin:0px"><li>Init<br><li>Prune<br><li>Expand<br><li>Prune<br><li>Factor<br><li>Prune<br><li>Tidy</ul>
</td></tr>
