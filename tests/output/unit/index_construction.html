<!doctype html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>tests/unit/index_construction</title>
		<script type='text/javascript' src='../tryToFindMathJax.js'></script>
	
		<style>
:root {
	--font-color: #000000;
	--bg-color: rgb(243,243,243);
}
[data-theme="dark"] {
	--font-color: #ffffff;
	--bg-color: #000000;
}

body {
	overflow : scroll;
	background : var(--bg-color);
	color : var(--font-color);
}

/* desktop chrome inputs have white background black font.  mobile chrome inputs have clear background black font. */
input {
	background : var(--bg-color);
	color : var(--font-color);
}
		</style>
		<script type='text/javascript'>
//https://stackoverflow.com/questions/56300132/how-to-override-css-prefers-color-scheme-setting
window.addEventListener('load', () => {
	let darkMode = false;
	if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
		darkMode = true;
	}
	if (darkMode) {
		document.documentElement.setAttribute('data-theme', 'dark');
	} else {
		document.documentElement.removeAttribute('data-theme', 'dark');
	}
});
		</script>


	</head>
	<body>

<table border="1" style="border-collapse:collapse">
<tr><td>
<b>upper by default</b><br>
<code>local x=a'i' 	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false})</code>
</td><td>
${ a} ^i$

<span style="color:green">GOOD</span>
</td><td>
time: 0.085000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'^i' 	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false})</code>
</td><td>
${ a} ^i$

<span style="color:green">GOOD</span>
</td><td>
time: 0.144000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'_i' 	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true})</code>
</td><td>
${ a} _i$

<span style="color:green">GOOD</span>
</td><td>
time: 0.041000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'ij' 	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false} and x[3]==Tensor.Index{symbol='j', lower=false})</code>
</td><td>
${{ a} ^i} ^j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.078000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'i_j' 	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false} and x[3]==Tensor.Index{symbol='j', lower=true})</code>
</td><td>
${{ a} ^i} _j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.043000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'^ij' 	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false} and x[3]==Tensor.Index{symbol='j', lower=false})</code>
</td><td>
${{ a} ^i} ^j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.038000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'^i_j'	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false} and x[3]==Tensor.Index{symbol='j', lower=true})</code>
</td><td>
${{ a} ^i} _j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.035000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'_i^j'	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true} and x[3]==Tensor.Index{symbol='j', lower=false})</code>
</td><td>
${{ a} _i} ^j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.131000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'_ij' 	print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true} and x[3]==Tensor.Index{symbol='j', lower=true})</code>
</td><td>
${{ a} _i} _j$

<span style="color:green">GOOD</span>
</td><td>
time: 0.043000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b>multi-char</b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b>upper by default</b><br>
<code>local x=a' i' 			print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false})</code>
</td><td>
${ a} ^i$

<span style="color:green">GOOD</span>
</td><td>
time: 0.103000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b>upper by default</b><br>
<code>local x=a' \\mu' 		print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='\\mu', lower=false})</code>
</td><td>
${ a} ^{\mu}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.104000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a' ^\\mu' 		print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='\\mu', lower=false})</code>
</td><td>
${ a} ^{\mu}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.164000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a' _\\mu' 		print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='\\mu', lower=true})</code>
</td><td>
${ a} _{\mu}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.060000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a' \\mu \\nu' print(x)	assert(#x==3 and x[1]==a and x[2]==Tensor.Index{symbol='\\mu', lower=false} and x[3]==Tensor.Index{symbol='\\nu', lower=false})</code>
</td><td>
${{ a} ^{\mu}} ^{\nu}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.076000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b>commas are lower by default</b><br>
<code>local x=a',i'	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true, derivative=','})</code>
</td><td>
${ a} _{,i}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.130000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a',^i'	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false, derivative=','})</code>
</td><td>
${ a} ^{,i}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.041000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a',_i'	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true, derivative=','})</code>
</td><td>
${ a} _{,i}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.029000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'^,i'	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=false, derivative=','})</code>
</td><td>
${ a} ^{,i}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.027000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code>local x=a'_,i'	print(x)	assert(#x==2 and x[1]==a and x[2]==Tensor.Index{symbol='i', lower=true, derivative=','})</code>
</td><td>
${ a} _{,i}$

<span style="color:green">GOOD</span>
</td><td>
time: 0.042000ms<br>
stack: size: 0<br><ul style="margin:0px"></ul>
</td></tr>
<tr><td>
<b></b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b>TODO multiple indexes with commas mixed</b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b>TODO multiple indexes with commas mixed with multiple chars</b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b></b><br>
<code></code>
</td><td>
</td><td>
</td></tr>
<tr><td>
<b></b><br>
<code>simplifyAssertNe(a'^,i', a'_,i')</code>
</td><td>
${{ a} ^{,i}} \ne {{ a} _{,i}}$
<br>

<span style="color:green">GOOD</span>
</td><td>
time: 0.969000ms<br>
stack: size: 7<br><ul style="margin:0px"><li>Init<br><li>Prune<br><li>Expand<br><li>Prune<br><li>Factor<br><li>Prune<br><li>Tidy</ul>
</td></tr>
